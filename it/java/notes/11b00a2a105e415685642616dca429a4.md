**[Spring Framework](https://www.youtube.com/playlist?list=PLC97BDEFDCDD169D7)**

# 入手
## 新建一个项目
- 新建 maven quickstart
- 添加依赖：
``` xml
    <dependency>
      <groupId>org.springframework</groupId>
      <artifactId>spring-context</artifactId>
      <version>3.0.5.RELEASE</version>
    </dependency>
    
    <dependency>
      <groupId>junit</groupId>
      <artifactId>junit</artifactId>
      <version>4.11</version>
      <scope>test</scope>
    </dependency>
```

## 三种方式

**1. 普通写法**

``` sh
touch src/main/java/org.example.Trangle.java
```
``` sh
package org.example;

public class Triangle {
    public void draw(){
        System.out.println("I am a triangle drawn.");
    }
}
```

``` sh
touch src/main/java/org.example.App.java
```
``` sh
package org.example;

public class App {
    public static void main( String[] args ) {
        Triangle triangle = new Triangle();
        triangle.draw();
    }
}
```

执行`main`方法。

**2. XmlBeanFactory**

在 `pom.xml` 的同级目录建立 `spring.xml`：
```xml
<?xml version="1.0" encoding="utf-8" ?>

<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN 2.0//EN" "http://www.springframework.org/dtd/spring-beans-2.0.dtd">

<beans>
    <bean id="triangle" class="org.example.Triangle"/>
</beans>
```

`App.java`:
``` sh
package org.example;


import org.springframework.beans.factory.BeanFactory;
import org.springframework.beans.factory.xml.XmlBeanFactory;
import org.springframework.core.io.FileSystemResource;

public class App {
    public static void main( String[] args ) {
        BeanFactory factory = new XmlBeanFactory(new FileSystemResource("spring.xml"));
        Triangle triangle= (Triangle) factory.getBean("triangle");
        triangle.draw();
    }
}
```

**3. ClassPathXmlApplicationContext**

``` sh
mkdir -p src/main/resources
mv spring.xml src/main/resources
```

`App.java`：
``` java
package org.example;

import org.springframework.context.ApplicationContext;
import org.springframework.context.support.ClassPathXmlApplicationContext;

public class App {
    public static void main( String[] args ) {
        ApplicationContext context = new ClassPathXmlApplicationContext("spring.xml");
        Triangle triangle= (Triangle) context.getBean("triangle");
        triangle.draw();
    }
}
```

## 使用构造函数注入
两种方式：

**1. property**
给 `Triangle.java` 加上 `type`:
``` java
package org.example;

public class Triangle {

  private String type;

  public String getType() {
    return type;
  }

  public void setType(String type) {
    this.type = type;
  }

  public void draw() {
    System.out.println(getType() + " I am a triangle drawn.");
  }
}
```
对应的 `spring.xml`：
``` xml
<?xml version="1.0" encoding="utf-8" ?>

<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN 2.0//EN"
  "http://www.springframework.org/dtd/spring-beans-2.0.dtd">

<beans>
  <bean class="org.example.Triangle" id="triangle">
    <property name="type" value="Equilateral"/>
  </bean>
</beans>
```
运行 `App.java` 会得到结果：`Equilateral I am a triangle drawn.`。


**2. constructor-arg**
给 `Triangle.java` 加上构造函数，并去掉 `setype()` 方法：
``` java
package org.example;

public class Triangle {

  private String type;

  public Triangle(String type) {
    this.type = type;
  }

  public String getType() {
    return type;
  }

  public void draw() {
    System.out.println(getType() + " I am a triangle drawn.");
  }
}
```


`spring.xml` 改写成：
``` xml
<?xml version="1.0" encoding="utf-8" ?>

<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN 2.0//EN"
  "http://www.springframework.org/dtd/spring-beans-2.0.dtd">

<beans>
  <bean class="org.example.Triangle" id="triangle">
    <constructor-arg value="Equilateral"/>
  </bean>
</beans>
```

运行 `App.java` 会得到结果：`Equilateral I am a triangle drawn.`。

**多个参数的情况：**
我们再给 `Triangle.java` 添加一个属性：
``` java
// ...
  private int height;

  public Triangle(String type) {
    this.type = type;
  }

  public Triangle(String type, int height) {
    this.type = type;
    this.height = height;
  }

  public int getHeight() {
    return height;
  }
  
// ...
```
`spring.xml` 如下：
```xml
<beans>
  <bean class="org.example.Triangle" id="triangle">
    <constructor-arg value="Equilateral"/>
    <constructor-arg value="20"/>
  </bean>
</beans>
```

运行结果：`Equilateral Triangle drawn of height 20`。

**多参数情况下，xml只配置一个参数：**
`Triangle.java` 再添加一个构造函数：
```java
  public Triangle(int height){
    this.height=height;
  }
```

如果 `spring.xml` 写成：
```xml
  <bean class="org.example.Triangle" id="triangle">
    <constructor-arg value="20"/>
  </bean>
```

那么执行 `App.java`，会认为 xml 中配置的是第一个参数 `type`，得到的结果就是
```
20 Triangle drawn of height 0
```

我们将 `spring.xml` 指定类型，改写成这样：
```xml
  <bean class="org.example.Triangle" id="triangle">
    <constructor-arg type="int" value="20"/>
  </bean>
```
得到的结果就是：
```
null Triangle drawn of height 20
```

**通过索引的形式：**
```xml
  <bean class="org.example.Triangle" id="triangle">
    <constructor-arg index="0" value="Equilateral"/>
    <constructor-arg index="1" value="20"/>
  </bean>
```
结果如下：
```
Equilateral Triangle drawn of height 20
```
